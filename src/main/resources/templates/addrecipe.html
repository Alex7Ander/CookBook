<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">	
	<head>
		<meta charset="utf-8">
		<link rel="stylesheet" th:href="@{/styles/style.css}" href="../static/styles/style.css" type="text/css">
		<link rel="stylesheet" th:href="@{/styles/add_recipe_style.css}" href="../static/styles/add_recipe_style.css" type="text/css">
		<link rel="stylesheet" th:href="@{/styles/pop_up.css}" href="../static/styles/pop_up.css" type="text/css">
		<script th:src="@{/js/jquery-3.4.1.js}" src="../static/js/jquery-3.4.1.js"></script>
		<script th:src="@{/js/asyncRequest.js}" src="../static/js/asyncRequest.js"></script>
		<script>
			$(document).ready(function(){
				//Скрыть PopUp при загрузке страницы    
				PopUpHide();
			});
			//Функция отображения PopUp
			function PopUpShow(){
				$("#add_ingr_popup").show();
			}
			//Функция скрытия PopUp
			function PopUpHide(){
				$("#add_ingr_popup").hide();
			}
			function DeleteIngr(){
				
			}
		</script>
		<title>Новый рецепт</title>	
	</head>
	<body>	
		<div class="main_info_conteiner">		
			<form id="saverecipeform" method="post" action="saverecipe">					
				<h4>Основная информация</h4><br>
				<b>Название:</b><br>
				<input type = "text" name = "name" placeholder = "Название рецепта"><br>
				<b>Категория:</b><br>
				<select>
					<option>Горячие блюда</option>
					<option>Гарниры</option>
					<option>Закуски</option>
					<option>Салаты</option>
					<option>Десерты</option>
					<option>Напитки</option>
					<option>Fast food</option>
				</select>
				<b>Слоган:</b><br>
				<input type = "text" name = "tagline" placeholder = "Слоган"><br>	
				<b>Ссылка на youtube:</b><br>
				<input form="saverecipeform" type = "text" name="youtubelink" placeholder = "https://www.youtube.com/..."></input><br>				
			</form>	
		</div>
		
		<div class="text_container">	
			<b>Алгоритм: </b><br>
			<textarea name="text" cols=170 rows=10>Итак, </textarea>									
		</div>
		
		<div>		
			<table>
				<tr>
					<th colspan = "3"><b>Ингридиенты</b></th>
				</tr>
				<tr>
					<th><b>Ингридиенты</b></th>
					<th><b>Количество (гр/мл)</b></th>
					<th><b>Управление</b></th>
				</tr>
				//recipeIngredients
				<tr th:each="ingredient : ${recipeIngredients}">
					<td><span th:text="${ingredient.name}"> - </span></td>
					<td><input type="text"></input></td>
					<td>
						<a href="javascript:DeleteIngr()">Удалить</a>
					</td>
				</tr>
				
				<tr>
					<th colspan="3"><a href="javascript:PopUpShow()">Добавить</a></th>
				<tr>
			</table>
		</div>	
		
		<div class="photo_conteiner">
			<table>
				<tr>
					<th colspan="6">Фото</th>
				</tr>
				<tr>
					<td> <img th:src="@{/img/noimg.png}" src="../static/img/noimg.png" /> </td>
					<td> <img th:src="@{/img/noimg.png}" src="../static/img/noimg.png" /> </td>
					<td> <img th:src="@{/img/noimg.png}" src="../static/img/noimg.png" /> </td>
					<td> <img th:src="@{/img/noimg.png}" src="../static/img/noimg.png" /> </td>
					<td> <img th:src="@{/img/noimg.png}" src="../static/img/noimg.png" /> </td>
					<td> <img th:src="@{/img/noimg.png}" src="../static/img/noimg.png" /> </td>
				</tr>
				<tr>
					<td> <button class = "dws-btn" type="submit">+</button> </td>
					<td> <button class = "dws-btn" type="submit">+</button> </td>
					<td> <button class = "dws-btn" type="submit">+</button> </td>
					<td> <button class = "dws-btn" type="submit">+</button> </td>
					<td> <button class = "dws-btn" type="submit">+</button> </td>
					<td> <button class = "dws-btn" type="submit">+</button> </td>
				</tr>
			</table>			
		</div>
		<button form="saverecipeform" class = "dws-btn" type="submit"> Сохранить </button>
		
	<!-- Pop up window for adding ingredient -->
		<div class="popup" id="add_ingr_popup">	
			<!-- AJAX script -->
			<script>
			function getIngrListFromServer(){
				req = new asyncRequest()
				element = document.getElementById('ingrList')
				alert("Element: " + element);
				req.onreadystatechange = function() {
					if (req.readyState == 4) {
						element.innerHTML = req.responseText
						if(req.status == 200) {
							alert("Ответ сервера: " + req.responseText);
						}
						else{
							alert("Error" + req.status);
						}
					}
				}
				req.open("GET", "/user/getIngrList", true)
				req.send("type")
				element.innerHTML = 'Ожидаю ответа сервера...'
			}
			</script>
			
			<div class="popup-content">
				<div>
					<form id="addIngr" method="post" action="addIngrToList"> </form>
					<b>Выбрать ингридиент</b><br>
					
					<b>Категория ингридиента:</b><br>
					<select name="type">
						<option value="none" hidden="">Выберите тип</option>
						<option th:each="type : ${ingrTypes}"> <p th:text=${type}> - </p> </option>
					</select>
					<input type="button" onclick="getIngrListFromServer()" value="Выбрать"/>
					
					<br>
					<b>Ингридиенты:</b><br>
					<div id="ingrList"><select>
						<option value="none" hidden="">Выберите игредиент</option>
						<option th:each="ingr : ${ingredients}"> <p th:text=${ingr.name}> - </p> </option>
					</select></div><br>
					<a href="javascript:PopUpHide()">Добавить</a>
					/
					<a href="javascript:PopUpHide()">Отмена</a>					
				</div>
				<div>
					<form>
					<b>Добавить новый ингридиент</b><br>	
					<b>Белки:</b><br>
					<input type = "text" name = "name" placeholder = "Белки / 100гр"><br>
					<b>Жиры:</b><br>
					<input type = "text" name = "name" placeholder = "Жиры / 100 гр"><br>
					<b>Углеводы:</b><br>
					<input type = "text" name = "name" placeholder = "Углеводы / 100 гр"><br>
					<a href="javascript:PopUpHide()">Сохранить новый и добавить его к рецепту</a>
					/
					<a href="javascript:PopUpHide()">Отмена</a>
					</form>
				</div>
			</div>
		</div>
		
	</body>
</html>